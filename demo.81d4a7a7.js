webpackJsonp([0,1],{"+iyJ":function(n,e){n.exports="var _this = this,\n    _store$handleActions;\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\n/** @jsx h */\nimport './style.css';\nimport { render, h, Component } from 'preact';\nimport { Provider, connect } from 'preact-smitty';\nimport { createStore } from '../../src';\nimport source from 'raw-loader!./App.js';\n\nvar store = createStore({\n  camera: {\n    recording: false,\n    stream: new window.MediaStream(),\n    images: []\n  }\n});\n\nstore.createActions({\n  startMediaStream: function startMediaStream() {\n    return function () {\n      var _ref = _asyncToGenerator(regeneratorRuntime.mark(function _callee(store) {\n        var stream;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return navigator.mediaDevices.getUserMedia({\n                  audio: false,\n                  video: true\n                });\n\n              case 3:\n                stream = _context.sent;\n\n                store.actions.mediaStreamSuccess(stream);\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context['catch'](0);\n\n                store.actions.mediaStreamError(_context.t0);\n\n              case 10:\n              case 'end':\n                return _context.stop();\n            }\n          }\n        }, _callee, _this, [[0, 7]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n  },\n  mediaStreamSuccess: 'camera/STREAM_SUCCESS',\n  mediaStreamError: 'camera/STREAM_ERROR',\n  saveImage: 'camera/ADD_IMAGE'\n});\n\nstore.handleActions((_store$handleActions = {}, _store$handleActions[store.actions.mediaStreamSuccess] = function (state, stream) {\n  state.camera.stream = stream;\n}, _store$handleActions[store.actions.mediaStreamError] = function (state, error) {\n  state.camera.streamError = error;\n}, _store$handleActions[store.actions.saveImage] = function (state, image) {\n  state.camera.images.push(image);\n}, _store$handleActions));\n\nvar pp = function pp(obj) {\n  return JSON.stringify(obj, null, 2);\n};\n\nvar Camera = connect(function (state) {\n  return {\n    stream: state.camera.stream,\n    streamError: state.camera.streamError\n  };\n})(function (_Component) {\n  _inherits(Camera, _Component);\n\n  function Camera() {\n    var _temp, _this2, _ret;\n\n    _classCallCheck(this, Camera);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this2 = _possibleConstructorReturn(this, _Component.call.apply(_Component, [this].concat(args))), _this2), _this2.video = null, _this2.canvas = null, _this2.handleClick = function () {\n      var canvas = _this2.canvas;\n      var ctx = canvas.getContext('2d');\n      var width = _this2.video.videoWidth;\n      var height = _this2.video.videoHeight;\n      canvas.width = width;\n      canvas.height = height;\n      ctx.fillRect(0, 0, width, height);\n      ctx.drawImage(_this2.video, 0, 0, width, height);\n\n      _this2.context.store.actions.saveImage(canvas.toDataURL('image/webp'));\n    }, _temp), _possibleConstructorReturn(_this2, _ret);\n  }\n\n  Camera.prototype.componentDidMount = function componentDidMount() {\n    var action = this.context.store.actions.startMediaStream('test');\n    action();\n  };\n\n  Camera.prototype.render = function render(_ref2) {\n    var _this3 = this;\n\n    var streamError = _ref2.streamError;\n\n    return h(\n      'div',\n      {\n        style: {\n          paddingTop: 16,\n          paddingRight: 16,\n          paddingBottom: 16,\n          paddingLeft: 16\n        }\n      },\n      h(\n        'h3',\n        { style: {\n            height: streamError ? 24 : 0,\n            lineHeight: '1.2',\n            marginBottom: 16,\n            textAlign: 'center', color: '#ff6b6b',\n            opacity: streamError ? 1 : 0,\n            transition: 'all 250ms ease-in-out'\n          } },\n        streamError ? streamError.name : ''\n      ),\n      h('video', {\n        ref: function ref(node) {\n          _this3.video = node;\n        },\n        style: {\n          width: '100%',\n          maxHeight: 'calc(50vh - 16px)',\n          background: '#212529',\n          cursor: 'pointer'\n        },\n        src: window.URL ? window.URL.createObjectURL(this.props.stream) : this.props.stream,\n        autoplay: true,\n        muted: true,\n        onClick: this.handleClick\n      }),\n      h('canvas', {\n        ref: function ref(node) {\n          _this3.canvas = node;\n        },\n        style: { display: 'none' }\n      }),\n      h(\n        'div',\n        {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            width: '100%',\n            marginTop: 16,\n            marginBottom: 16\n          }\n        },\n        h(\n          'button',\n          {\n            style: {\n              paddingTop: 8,\n              paddingRight: 16,\n              paddingBottom: 8,\n              paddingLeft: 16,\n              margin: '0 auto',\n              fontSize: 20,\n              lineHeight: '1.6',\n              color: '#adb5bd',\n              background: '#343a40',\n              border: 'none',\n              outline: 'none',\n              boxShadow: 'none',\n              borderRadius: 5,\n              cursor: 'pointer',\n              opacity: streamError ? 0 : 1,\n              transition: 'all 250ms ease-in-out'\n            },\n            disabled: streamError,\n            type: 'button',\n            onClick: this.handleClick\n          },\n          'Take Picture'\n        )\n      )\n    );\n  };\n\n  return Camera;\n}(Component));\n\nvar ImageList = connect(function (state) {\n  return {\n    images: state.camera.images\n  };\n})(function ImageList(_ref3) {\n  var images = _ref3.images;\n\n  return h(\n    'div',\n    {\n      style: {\n        display: 'flex',\n        flexFlow: 'wrap'\n      }\n    },\n    images.map(function (image, i) {\n      return h(Image, { image: image, index: i });\n    })\n  );\n});\n\nfunction Image(_ref4) {\n  var image = _ref4.image,\n      index = _ref4.index;\n\n  return h(\n    'a',\n    {\n      style: {\n        position: 'relative',\n        flex: '0 0 auto',\n        width: '33%',\n        order: index * -1\n      },\n      href: image\n    },\n    h('img', { src: image, style: { width: '100%' } })\n  );\n}\n\nfunction GithubRibbon() {\n  return h('iframe', {\n    src: 'https://ghbtns.com/github-btn.html?user=tkh44&repo=smitty&type=star&count=true&size=large',\n    frameborder: '0',\n    scrolling: '0',\n    width: '160px',\n    height: '30px',\n    style: { marginLeft: 'auto' }\n  });\n}\n\nvar App = connect(function (state) {\n  return state;\n})(function (props) {\n  var _ref5;\n\n  return h(\n    'div',\n    { style: { display: 'flex' } },\n    h(\n      'div',\n      {\n        style: (_ref5 = {\n          flex: '1 0 50%',\n          height: '100vh',\n          background: '#212529',\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch'\n        }, _ref5['background'] = props.camera.streamError ? '#f8f9fa' : '#212529', _ref5.cursor = 'pointer', _ref5.transition = 'all 250ms ease-in-out', _ref5)\n      },\n      h(Camera, null)\n    ),\n    h(\n      'div',\n      {\n        style: {\n          flex: '1 0 50%',\n          height: '100vh',\n          background: '#f8f9fa',\n          borderLeft: '1px solid #dee2e6',\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch'\n        }\n      },\n      h(\n        'div',\n        {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            borderBottom: '1px solid #dee2e6',\n            paddingRight: 8,\n            paddingLeft: 8\n          }\n        },\n        h(\n          'h2',\n          null,\n          'Smitty Demo'\n        ),\n        h(\n          'a',\n          {\n            href: 'https://github.com/tkh44/smitty/tree/master/demo/src',\n            style: { fontSize: '1rem', color: '#329af0', marginLeft: 8 },\n            target: '_blank'\n          },\n          'source'\n        ),\n        h(GithubRibbon, null)\n      ),\n      h(ImageList, null)\n    )\n  );\n});\n\nvar Root = function Root(props) {\n  return h(\n    Provider,\n    { store: store },\n    h(App, null)\n  );\n};\n\nexport default Root;"},0:function(n,e,t){n.exports=t("ctQG")},"97Jz":function(n,e,t){function r(n){function e(e,t){if("function"==typeof n)return n(t.store.state,e)}return function(n){return function(t){function r(n,r){var o=this;t.call(this,n,r),this.state=e(n,r),this.handleStoreUpdate=function(){o.updateAnimId=setTimeout(function(){o.setState(e(o.props,o.context))})},r.store.on("*",this.handleStoreUpdate)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.componentWillUnmount=function(){window.clearTimeout(this.updateAnimId),this.context.store.off("*",this.handleStoreUpdate)},r.prototype.render=function(e,t){return o.h(n,Object.assign({},Object.assign({},e),t,{emit:this.context.store.emit}))},r}(o.Component)}}Object.defineProperty(e,"__esModule",{value:!0});var o=t("EF6w"),i=function(n){function e(){n.apply(this,arguments)}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.getChildContext=function(){return{store:this.props.store}},e.prototype.render=function(n){return n.children[0]},e}(o.Component);e.Provider=i,e.connect=r},EF6w:function(n,e,t){!function(n,t){t(e)}(this,function(n){function e(n,e,t){this.nodeName=n,this.attributes=e,this.children=t,this.key=e&&e.key}function t(n,t){var r,o,i,a,s;for(s=arguments.length;s-- >2;)D.push(arguments[s]);for(t&&t.children&&(D.length||D.push(t.children),delete t.children);D.length;)if((i=D.pop())instanceof Array)for(s=i.length;s--;)D.push(i[s]);else null!=i&&i!==!0&&i!==!1&&("number"==typeof i&&(i=String(i)),a="string"==typeof i,a&&o?r[r.length-1]+=i:((r||(r=[])).push(i),o=a));var c=new e(n,t||void 0,r||W);return B.vnode&&B.vnode(c),c}function r(n,e){if(e)for(var t in e)n[t]=e[t];return n}function o(n){return r({},n)}function i(n,e){for(var t=e.split("."),r=0;r<t.length&&n;r++)n=n[t[r]];return n}function a(n){return"function"==typeof n}function s(n){return"string"==typeof n}function c(n){var e="";for(var t in n)n[t]&&(e&&(e+=" "),e+=t);return e}function u(n,e){return t(n.nodeName,r(o(n.attributes),e),arguments.length>2?[].slice.call(arguments,2):n.children)}function l(n,e,t){var r=e.split(".");return function(e){for(var o=e&&e.target||this,a={},c=a,u=s(t)?i(e,t):o.nodeName?o.type.match(/^che|rad/)?o.checked:o.value:e,l=0;l<r.length-1;l++)c=c[r[l]]||(c[r[l]]=!l&&n.state[r[l]]||{});c[r[l]]=u,n.setState(a)}}function f(n){!n._dirty&&(n._dirty=!0)&&1==Q.push(n)&&(B.debounceRendering||F)(p)}function p(){var n,e=Q;for(Q=[];n=e.pop();)n._dirty&&U(n)}function d(n){var e=n&&n.nodeName;return e&&a(e)&&!(e.prototype&&e.prototype.render)}function m(n,e){return n.nodeName(g(n),e||V)}function h(n,e){return s(e)?n instanceof Text:s(e.nodeName)?!n._componentConstructor&&v(n,e.nodeName):a(e.nodeName)?!n._componentConstructor||n._componentConstructor===e.nodeName||d(e):void 0}function v(n,e){return n.normalizedNodeName===e||H(n.nodeName)===H(e)}function g(n){var e=o(n.attributes);e.children=n.children;var t=n.nodeName.defaultProps;if(t)for(var r in t)void 0===e[r]&&(e[r]=t[r]);return e}function y(n){var e=n.parentNode;e&&e.removeChild(n)}function _(n,e,t,r,o){if("className"===e&&(e="class"),"class"===e&&r&&"object"==typeof r&&(r=c(r)),"key"===e);else if("class"!==e||o)if("style"===e){if((!r||s(r)||s(t))&&(n.style.cssText=r||""),r&&"object"==typeof r){if(!s(t))for(var i in t)i in r||(n.style[i]="");for(var i in r)n.style[i]="number"!=typeof r[i]||J[i]?r[i]:r[i]+"px"}}else if("dangerouslySetInnerHTML"===e)r&&(n.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var u=n._listeners||(n._listeners={});e=H(e.substring(2)),r?u[e]||n.addEventListener(e,x,!!K[e]):u[e]&&n.removeEventListener(e,x,!!K[e]),u[e]=r}else if("list"!==e&&"type"!==e&&!o&&e in n)b(n,e,null==r?"":r),null!=r&&r!==!1||n.removeAttribute(e);else{var l=o&&e.match(/^xlink\:?(.+)/);null==r||r===!1?l?n.removeAttributeNS("http://www.w3.org/1999/xlink",H(l[1])):n.removeAttribute(e):"object"==typeof r||a(r)||(l?n.setAttributeNS("http://www.w3.org/1999/xlink",H(l[1]),r):n.setAttribute(e,r))}else n.className=r||""}function b(n,e,t){try{n[e]=t}catch(n){}}function x(n){return this._listeners[n.type](B.event&&B.event(n)||n)}function w(n){if(y(n),n instanceof Element){n._component=n._componentConstructor=null;var e=n.normalizedNodeName||H(n.nodeName);(q[e]||(q[e]=[])).push(n)}}function C(n,e){var t=H(n),r=q[t]&&q[t].pop()||(e?document.createElementNS("http://www.w3.org/2000/svg",n):document.createElement(n));return r.normalizedNodeName=t,r}function S(){for(var n;n=X.pop();)B.afterMount&&B.afterMount(n),n.componentDidMount&&n.componentDidMount()}function k(n,e,t,r,o,i){Y++||(Z=o&&void 0!==o.ownerSVGElement,nn=n&&!($ in n));var a=E(n,e,t,r);return o&&a.parentNode!==o&&o.appendChild(a),--Y||(nn=!1,i||S()),a}function E(n,e,t,r){for(var o=e&&e.attributes&&e.attributes.ref;d(e);)e=m(e,t);if(null==e&&(e=""),s(e))return n&&n instanceof Text&&n.parentNode?n.nodeValue!=e&&(n.nodeValue=e):(n&&R(n),n=document.createTextNode(e)),n;if(a(e.nodeName))return M(n,e,t,r);var i=n,c=String(e.nodeName),u=Z,l=e.children;if(Z="svg"===c||"foreignObject"!==c&&Z,n){if(!v(n,c)){for(i=C(c,Z);n.firstChild;)i.appendChild(n.firstChild);n.parentNode&&n.parentNode.replaceChild(i,n),R(n)}}else i=C(c,Z);var f=i.firstChild,p=i[$];if(!p){i[$]=p={};for(var h=i.attributes,g=h.length;g--;)p[h[g].name]=h[g].value}return!nn&&l&&1===l.length&&"string"==typeof l[0]&&f&&f instanceof Text&&!f.nextSibling?f.nodeValue!=l[0]&&(f.nodeValue=l[0]):(l&&l.length||f)&&N(i,l,t,r,!!p.dangerouslySetInnerHTML),A(i,e.attributes,p),o&&(p.ref=o)(i),Z=u,i}function N(n,e,t,r,o){var i,a,s,c,u=n.childNodes,l=[],f={},p=0,d=0,m=u.length,v=0,g=e&&e.length;if(m)for(var _=0;_<m;_++){var b=u[_],x=b[$],w=g?(a=b._component)?a.__key:x?x.key:null:null;null!=w?(p++,f[w]=b):(nn||o||x||b instanceof Text)&&(l[v++]=b)}if(g)for(var _=0;_<g;_++){s=e[_],c=null;var w=s.key;if(null!=w)p&&w in f&&(c=f[w],f[w]=void 0,p--);else if(!c&&d<v)for(i=d;i<v;i++)if((a=l[i])&&h(a,s)){c=a,l[i]=void 0,i===v-1&&v--,i===d&&d++;break}c=E(c,s,t,r),c&&c!==n&&(_>=m?n.appendChild(c):c!==u[_]&&(c===u[_+1]&&y(u[_]),n.insertBefore(c,u[_]||null)))}if(p)for(var _ in f)f[_]&&R(f[_]);for(;d<=v;)(c=l[v--])&&R(c)}function R(n,e){var t=n._component;if(t)L(t,!e);else{n[$]&&n[$].ref&&n[$].ref(null),e||w(n);for(var r;r=n.lastChild;)R(r,e)}}function A(n,e,t){var r;for(r in t)e&&r in e||null==t[r]||_(n,r,t[r],t[r]=void 0,Z);if(e)for(r in e)"children"===r||"innerHTML"===r||r in t&&e[r]===("value"===r||"checked"===r?n[r]:t[r])||_(n,r,t[r],t[r]=e[r],Z)}function j(n){var e=n.constructor.name,t=en[e];t?t.push(n):en[e]=[n]}function O(n,e,t){var r=new n(e,t),o=en[n.name];if(P.call(r,e,t),o)for(var i=o.length;i--;)if(o[i].constructor===n){r.nextBase=o[i].nextBase,o.splice(i,1);break}return r}function T(n,e,t,r,o){n._disable||(n._disable=!0,(n.__ref=e.ref)&&delete e.ref,(n.__key=e.key)&&delete e.key,!n.base||o?n.componentWillMount&&n.componentWillMount():n.componentWillReceiveProps&&n.componentWillReceiveProps(e,r),r&&r!==n.context&&(n.prevContext||(n.prevContext=n.context),n.context=r),n.prevProps||(n.prevProps=n.props),n.props=e,n._disable=!1,0!==t&&(1!==t&&B.syncComponentUpdates===!1&&n.base?f(n):U(n,1,o)),n.__ref&&n.__ref(n))}function U(n,e,t,i){if(!n._disable){var s,c,u,l,f=n.props,p=n.state,h=n.context,v=n.prevProps||f,y=n.prevState||p,_=n.prevContext||h,b=n.base,x=n.nextBase,w=b||x,C=n._component;if(b&&(n.props=v,n.state=y,n.context=_,2!==e&&n.shouldComponentUpdate&&n.shouldComponentUpdate(f,p,h)===!1?s=!0:n.componentWillUpdate&&n.componentWillUpdate(f,p,h),n.props=f,n.state=p,n.context=h),n.prevProps=n.prevState=n.prevContext=n.nextBase=null,n._dirty=!1,!s){for(n.render&&(c=n.render(f,p,h)),n.getChildContext&&(h=r(o(h),n.getChildContext()));d(c);)c=m(c,h);var E,N,A=c&&c.nodeName;if(a(A)){var j=g(c);u=C,u&&u.constructor===A&&j.key==u.__key?T(u,j,1,h):(E=u,u=O(A,j,h),u.nextBase=u.nextBase||x,u._parentComponent=n,n._component=u,T(u,j,0,h),U(u,1,t,!0)),N=u.base}else l=w,E=C,E&&(l=n._component=null),(w||1===e)&&(l&&(l._component=null),N=k(l,c,h,t||!b,w&&w.parentNode,!0));if(w&&N!==w&&u!==C){var M=w.parentNode;M&&N!==M&&(M.replaceChild(N,w),E||(w._component=null,R(w)))}if(E&&L(E,N!==w),n.base=N,N&&!i){for(var P=n,I=n;I=I._parentComponent;)(P=I).base=N;N._component=P,N._componentConstructor=P.constructor}}!b||t?X.unshift(n):s||(n.componentDidUpdate&&n.componentDidUpdate(v,y,_),B.afterUpdate&&B.afterUpdate(n));var D,W=n._renderCallbacks;if(W)for(;D=W.pop();)D.call(n);Y||i||S()}}function M(n,e,t,r){for(var o=n&&n._component,i=o,a=n,s=o&&n._componentConstructor===e.nodeName,c=s,u=g(e);o&&!c&&(o=o._parentComponent);)c=o.constructor===e.nodeName;return o&&c&&(!r||o._component)?(T(o,u,3,t,r),n=o.base):(i&&!s&&(L(i,!0),n=a=null),o=O(e.nodeName,u,t),n&&!o.nextBase&&(o.nextBase=n,a=null),T(o,u,1,t,r),n=o.base,a&&n!==a&&(a._component=null,R(a))),n}function L(n,e){B.beforeUnmount&&B.beforeUnmount(n);var t=n.base;n._disable=!0,n.componentWillUnmount&&n.componentWillUnmount(),n.base=null;var r=n._component;if(r)L(r,e);else if(t){t[$]&&t[$].ref&&t[$].ref(null),n.nextBase=t,e&&(y(t),j(n));for(var o;o=t.lastChild;)R(o,!e)}n.__ref&&n.__ref(null),n.componentDidUnmount&&n.componentDidUnmount()}function P(n,e){this._dirty=!0,this.context=e,this.props=n,this.state||(this.state={})}function I(n,e,t){return k(t,n,{},!1,e)}var B={},D=[],W=[],z={},H=function(n){return z[n]||(z[n]=n.toLowerCase())},G="undefined"!=typeof Promise&&Promise.resolve(),F=G?function(n){G.then(n)}:setTimeout,V={},$="undefined"!=typeof Symbol?Symbol.for("preactattr"):"__preactattr_",J={boxFlex:1,boxFlexGroup:1,columnCount:1,fillOpacity:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,strokeOpacity:1,widows:1,zIndex:1,zoom:1},K={blur:1,error:1,focus:1,load:1,resize:1,scroll:1},Q=[],q={},X=[],Y=0,Z=!1,nn=!1,en={};r(P.prototype,{linkState:function(n,e){var t=this._linkedStates||(this._linkedStates={});return t[n+e]||(t[n+e]=l(this,n,e))},setState:function(n,e){var t=this.state;this.prevState||(this.prevState=o(t)),r(t,a(n)?n(t,this.props):n),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),f(this)},forceUpdate:function(){U(this,2)},render:function(){}}),n.h=t,n.cloneElement=u,n.Component=P,n.render=I,n.rerender=p,n.options=B})},NNls:function(n,e){},ctQG:function(n,e,t){"use strict";function r(){var n=t("jFIt").default;i=t.i(o.render)(t.i(o.h)(n,{test:"foo"}),document.querySelector("#demo"),i)}Object.defineProperty(e,"__esModule",{value:!0});var o=t("EF6w"),i=(t.n(o),void 0);r()},jFIt:function(n,e,t){"use strict";function r(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function o(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?n:e}function i(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}function a(n){return function(){var e=n.apply(this,arguments);return new Promise(function(n,t){function r(o,i){try{var a=e[o](i),s=a.value}catch(n){return void t(n)}if(!a.done)return Promise.resolve(s).then(function(n){r("next",n)},function(n){r("throw",n)});n(s)}return r("next")})}}function s(n){var e=n.image,r=n.index;return t.i(f.h)("a",{style:{position:"relative",flex:"0 0 auto",width:"33%",order:r*-1},href:e},t.i(f.h)("img",{src:e,style:{width:"100%"}}))}function c(){return t.i(f.h)("iframe",{src:"https://ghbtns.com/github-btn.html?user=tkh44&repo=smitty&type=star&count=true&size=large",frameborder:"0",scrolling:"0",width:"160px",height:"30px",style:{marginLeft:"auto"}})}Object.defineProperty(e,"__esModule",{value:!0});var u,l=t("NNls"),f=(t.n(l),t("EF6w")),p=(t.n(f),t("97Jz")),d=(t.n(p),t("lVK7")),m=t("+iyJ"),h=(t.n(m),this),v=t.i(d.a)({camera:{recording:!1,stream:new window.MediaStream,images:[]}});v.createActions({startMediaStream:function(){return function(){var n=a(regeneratorRuntime.mark(function n(e){var t;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,navigator.mediaDevices.getUserMedia({audio:!1,video:!0});case 3:t=n.sent,e.actions.mediaStreamSuccess(t),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),e.actions.mediaStreamError(n.t0);case 10:case"end":return n.stop()}},n,h,[[0,7]])}));return function(e){return n.apply(this,arguments)}}()},mediaStreamSuccess:"camera/STREAM_SUCCESS",mediaStreamError:"camera/STREAM_ERROR",saveImage:"camera/ADD_IMAGE"}),v.handleActions((u={},u[v.actions.mediaStreamSuccess]=function(n, e){n.camera.stream=e},u[v.actions.mediaStreamError]=function(n, e){n.camera.streamError=e},u[v.actions.saveImage]=function(n, e){n.camera.images.push(e)},u));var g=t.i(p.connect)(function(n){return{stream:n.camera.stream,streamError:n.camera.streamError}})(function(n){function e(){var t,i,a;r(this,e);for(var s=arguments.length,c=Array(s),u=0; u<s; u++)c[u]=arguments[u];return t=i=o(this,n.call.apply(n,[this].concat(c))),i.video=null,i.canvas=null,i.handleClick=function(){var n=i.canvas,e=n.getContext("2d"),t=i.video.videoWidth,r=i.video.videoHeight;n.width=t,n.height=r,e.fillRect(0,0,t,r),e.drawImage(i.video,0,0,t,r),i.context.store.actions.saveImage(n.toDataURL("image/webp"))},a=t,o(i,a)}return i(e,n),e.prototype.componentDidMount=function(){this.context.store.actions.startMediaStream("test")()},e.prototype.render=function(n){var e=this,r=n.streamError;return t.i(f.h)("div",{style:{paddingTop:16,paddingRight:16,paddingBottom:16,paddingLeft:16}},t.i(f.h)("h3",{style:{height:r?24:0,lineHeight:"1.2",marginBottom:16,textAlign:"center",color:"#ff6b6b",opacity:r?1:0,transition:"all 250ms ease-in-out"}},r?r.name:""),t.i(f.h)("video",{ref:function(n){e.video=n},style:{width:"100%",maxHeight:"calc(50vh - 16px)",background:"#212529",cursor:"pointer"},src:window.URL?window.URL.createObjectURL(this.props.stream):this.props.stream,autoplay:!0,muted:!0,onClick:this.handleClick}),t.i(f.h)("canvas",{ref:function(n){e.canvas=n},style:{display:"none"}}),t.i(f.h)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",marginTop:16,marginBottom:16}},t.i(f.h)("button",{style:{paddingTop:8,paddingRight:16,paddingBottom:8,paddingLeft:16,margin:"0 auto",fontSize:20,lineHeight:"1.6",color:"#adb5bd",background:"#343a40",border:"none",outline:"none",boxShadow:"none",borderRadius:5,cursor:"pointer",opacity:r?0:1,transition:"all 250ms ease-in-out"},disabled:r,type:"button",onClick:this.handleClick},"Take Picture")))},e}(f.Component)),y=t.i(p.connect)(function(n){return{images:n.camera.images}})(function(n){var e=n.images;return t.i(f.h)("div",{style:{display:"flex",flexFlow:"wrap"}},e.map(function(n,e){return t.i(f.h)(s,{image:n,index:e})}))}),_=t.i(p.connect)(function(n){return n})(function(n){var e;return t.i(f.h)("div",{style:{display:"flex"}},t.i(f.h)("div",{style:(e={flex:"1 0 50%",height:"100vh",background:"#212529",overflow:"auto",WebkitOverflowScrolling:"touch"},e.background=n.camera.streamError?"#f8f9fa":"#212529",e.cursor="pointer",e.transition="all 250ms ease-in-out",e)},t.i(f.h)(g,null)),t.i(f.h)("div",{style:{flex:"1 0 50%",height:"100vh",background:"#f8f9fa",borderLeft:"1px solid #dee2e6",overflow:"auto",WebkitOverflowScrolling:"touch"}},t.i(f.h)("div",{style:{display:"flex",alignItems:"center",borderBottom:"1px solid #dee2e6",paddingRight:8,paddingLeft:8}},t.i(f.h)("h2",null,"Smitty Demo"),t.i(f.h)("a",{href:"https://github.com/tkh44/smitty/tree/master/demo/src",style:{fontSize:"1rem",color:"#329af0",marginLeft:8},target:"_blank"},"source"),t.i(f.h)(c,null)),t.i(f.h)(y,null)))}),b=function(n){return t.i(f.h)(p.Provider,{store:v},t.i(f.h)(_,null))};e.default=b},lVK7:function(n,e,t){"use strict";function r(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function o(n){return new c(n)}var i=t("tNdy"),a=t.n(i);e.a=o;var s=function(){function n(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),c=function(){function n(e){r(this,n),this._state=e,this.actions={},this.events=a()(),this.on=this.events.on,this.off=this.events.off,this.emit=this.emit.bind(this),this.handleActions=this.handleActions.bind(this)}return n.prototype.emit=function(n, e){if("function"==typeof n)return n(this);this.events.emit(n,e)},n.prototype.createAction=function(n){var e=this;if("function"==typeof n)return function(t){return e.emit(n(t))};var t=function(t){return e.emit(n,t)};return t.toString=function(){return n.toString()},t},n.prototype.createActions=function(n){for(var e in n)this.actions[e]=this.createAction(n[e])},n.prototype.handleActions=function(n){var e=this,t=function(t){var r=function(r, o){"store:"!==r.substring(0,6)&&(e.state=n[t](e.state,o,r)||e.state,e.events.emit("store:change",e.state))};"*"!==t&&(r=r.bind(null,t)),e.events.on(t,r)};for(var r in n)t(r)},s(n,[{key:"state",get:function(){return this._state},set:function(n){this._state=n}}]),n}()},tNdy:function(n, e){function t(n){return n=n||Object.create(null),{on:function(e, t){(n[e]||(n[e]=[])).push(t)},off:function(e, t){var r=n[e]||(n[e]=[]);r.splice(r.indexOf(t)>>>0,1)},emit:function(e, t){(n[e]||[]).map(function(n){n(t)}),(n["*"]||[]).map(function(n){n(e,t)})}}}n.exports=t}},[0]);
//# sourceMappingURL=demo.81d4a7a7.js.map
